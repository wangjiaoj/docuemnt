# 移动端那些年踩过的坑

## 一、布局兼容性
Vw,vh:
* andriod 4.4+
* ios 6开始部分支持，8完美支持包括VMAX

## 二、ios布局系列问题整理

#### 2.2、fix布局失效问题
 在手机键盘打开后，fix布局失效，布局效果类似relative,需要使用其他布局方案来做代替

#### 3.3、ios的滚动布局问题
ios的固定列，横向纵向滚动表格,左侧固定列,右侧为滚动列。
使用监听滚动,右侧列的固定表头设置绝对定位,left的

#### 2.4、ios软键盘打开对于绝对定位absolute也会有一定影响

#### 2.4 百分比和rem布局混用
rem布局和百分比布局不能混用的情况；
例如：一个横向滚动列表，最外侧容器使用100%，列表项目使用rem布局，会导致在ios上布局混乱。
但html根元素使用rem内部元素使用%。

#### 2.4 固定列滚动横向和纵向加载列表

之前方案： 
* 整体容器允许纵向滚动,左侧固定列，右侧横向滚动列,列内分为表头和表体。
* 右侧列的表头相对于整体容器绝对定位,监听右侧列表的横向滚动，设置表头的left。

修改方案：
* 表头和表体拆分,分别分成左右两列。
* 监听右列表体的滚动，修正右列表头的scrollLeft。
 

### 三、ios移动端的其他兼容性问题

#### 3.1、ios-input光标问题
 做一个模拟弹窗，input点击触发弹窗打开，存在一个问题，input中的光标，在弹窗打开后，依然可以看到,input设置成readonly依然存在这一问题，需要设置input类型为disabled:disabled才能够解决。

#### 3.2、ios-history.back()页面不刷新问题
返回上一个页面,ios只是恢复了上一个页面，所以数据刷新或者其他需要页面返回后进行的操作需要ios中捕获相应返回事件，在对应事件中定义处理(onPageShow)

#### 3.3、ios-input输入后页面操作无法点击
下单弹窗无反应的原因是：ios键盘打开，会把页面往上顶，如果输入完数字，直接点击下单按钮，被顶上去的页面无法恢复，导致弹窗点击无反应。修改方案：ios端，监听输入框失去焦点事件，失去焦点之后，调用js把页面滚动到顶。


### 四、移动端其他问题整理

#### 4.1 移动端不要使用input type=number，无法正常使用
如果需要实现类似功能，只能keyUP或keyDown,或者change事件处理

#### 4.2 try catch随便删掉是不好的习惯

#### 4.3 移动端不能兼容或处理的那些事件
* 关闭当前页面
window.close() and self.close() 是不能关闭非弹出窗口（opener=null及非window.open()打开的窗口）。随着chrome浏览器升级，之前有效的关闭页面的API也都逐渐失效，总之就是不要想着开发来主动关闭页面了。

* 捕获页面退出并给出弹窗提示问题
chormePC端是可以捕获到关闭或退出页面事件用原生alert来做提示的，但其他浏览器不可，移动端也不可以。
### 4.4.页面报错崩溃
ios: 待确认:ios页面遇到代码报错崩溃后，自动刷新页面;
安卓:
### 五、移动端优化
* 防抖函数
* 聚焦
* 固定列滚动列表加载
* 
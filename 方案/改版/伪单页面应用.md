# 伪单页面应用思路整理

##  一、利用iframe实现伪单页面应用思路

## 1.1. 适用范围
系统首先需要是类后台管理系统(由登录页面,统一页面结构的登录后页面构成)。
想要实现类似单页面应用的效果,但直接改造成单页面应用成本太高的项目。
想要实现页面内类多标签展示(多页面展示)效果的项目。

## 1.2. 实现思路简单描述 
1. 概念：
登录页面Login;
登陆后根页面Index(外侧框架部分);
Index页面的主内容区域MainContent; 

2. 基础思路

* 1)、要把页面的侧边栏,头部,底部,消息栏等页面统一的交互逻辑都调整到Index中去,中间主内容区域MainContent部分使用iframe控制页面展示;

* 2)、登录后其他页面统一改造成iframe的形式嵌入到MainContent中去,此处可以考虑是否设置成多标签展示。

## 1.3. 页面内单标签展示效果

Index的header部分可以作为菜单栏可以利用起来,MainContent区域的页面跳转加载时,只显示加载MainContent部分即可。


## 1.4. 页面内类多标签展示效果

MainContent区域设置成tab页效果。各个tab标签的内容区域，使用iframe嵌入页面。

UI:
[UI参考](http://admin.iviewui.com/home)
[投研](http://172.19.80.72/invest-research-web/login)
[项目组管理系统](http://172.19.80.72/iptms-web/main/monitor/metricManage)

因为Index页面头部被标签页占据,所以一般菜单栏都放在页面左侧。
投研方面应用调整：
* 个人中心，tab标签栏向上平移? 如果后期考虑增加一下其他功能,那就保留头部
* 导航标签栏和右侧菜单栏的联动
* loading效果调整(目前loading覆盖整个页面)
* 多弹窗展示,相互覆盖(考虑重新设计交互)

### 1.4.1  多标签功能点

需要完成标签页操作时的管理

1. 导航标签和右侧菜单栏的联动管理

1. tab标签的创建：
  * creatTab传递(tabName,URL,刷新状态)作为参数;经过URL检验是否该tab页是否已经存在,不存在的话需要新增tab，在新tab内创建iframe打开URL;否则找到对应已经打开的tab页,设置选中展示状态,并根据刷新状态对页面进行刷新。
   一般直接使用URL链接判断校验即可，无需考虑URL后拼接的参数。

2. 报错页面处理：
  目前主要两种报错,一种ajax数据请求时接口报错(统一拦截弹窗提示),另一种情况是dom页面返回报错(可能存在页面强制跳转)。
 对于嵌入的iframe页面, 强制跳转到报错页面,影响也不太大。
* 需要统一页面数据传递
  通用方法包装处理一下iframe页面和父页面的通信。可能存在一些iframe内嵌页面点击,需要新开一个tab页或刷新父页面等逻辑。

### 1.4.2. 设计交互的功能点





### 1.3.3.  其他注意事项
Index页面的组件和样式需要统一打包。
其他嵌入的iframe页面引入的通用js组件和css可以再统一调整打包。